(function(){var n,hi,ci,bt,li,kt,at,dt,w,d,s,y,rt,ft,l,e,p,ai,g,h,c,i,gt,et,vi,yi,ot,pi,wi,hr,bi,ki,di,nt,f,u,gi,ni,ti,nr,vt,tr,ir,yt,a,ii,ut,cr,ri,pt,b,ui,fi,st,k,o,ei,ht,rr,tt,ct,lt,wt,ur,fr,oi,er,or,t,si,sr={}.hasOwnProperty,v=function(n,t){function r(){this.constructor=n}for(var i in t)sr.call(t,i)&&(n[i]=t[i]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n},r=[].slice,it=function(n,t){return function(){return n.apply(t,arguments)}};n={toString:function(){return"Bacon"}};n.version="0.7.53";y=(typeof global!="undefined"&&global!==null?global:this).Error;o=function(){};cr=function(n,t){return t};tr=function(n){return n};bi=function(n){return n.slice(0)};et=function(n,t){if(!t)throw new y(n);};yi=function(n){if(!(n instanceof s))throw new y("not an EventStream : "+n);};wi=function(n){if(!(n instanceof e))throw new y("not an Observable : "+n);};ot=function(n){return et("not a function : "+n,i.isFunction(n))};a=function(n){return n instanceof Array};ut=function(n){return n instanceof e};vi=function(n){if(!a(n))throw new y("not an array : "+n);};pi=function(n){return et("no arguments supported",n.length===0)};hr=function(n){if(typeof n!="string")throw new y("not a string : "+n);};i={indexOf:Array.prototype.indexOf?function(n,t){return n.indexOf(t)}:function(n,t){for(var r,f,i=r=0,u=n.length;r<u;i=++r)if(f=n[i],t===f)return i;return-1},indexWhere:function(n,t){for(var r,f,i=r=0,u=n.length;r<u;i=++r)if(f=n[i],t(f))return i;return-1},head:function(n){return n[0]},always:function(n){return function(){return n}},negate:function(n){return function(t){return!n(t)}},empty:function(n){return n.length===0},tail:function(n){return n.slice(1,n.length)},filter:function(n,t){var r,i,f,u;for(r=[],i=0,f=t.length;i<f;i++)u=t[i],n(u)&&r.push(u);return r},map:function(n,t){var i,u,r,f;for(r=[],i=0,u=t.length;i<u;i++)f=t[i],r.push(n(f));return r},each:function(n,t){var i,r;for(i in n)r=n[i],t(i,r);return void 0},toArray:function(n){return a(n)?n:[n]},contains:function(n,t){return i.indexOf(n,t)!==-1},id:function(n){return n},last:function(n){return n[n.length-1]},all:function(n,t){var r,u,f;for(t==null&&(t=i.id),r=0,u=n.length;r<u;r++)if(f=n[r],!t(f))return!1;return!0},any:function(n,t){var r,u,f;for(t==null&&(t=i.id),r=0,u=n.length;r<u;r++)if(f=n[r],t(f))return!0;return!1},without:function(n,t){return i.filter(function(t){return t!==n},t)},remove:function(n,t){var r;return r=i.indexOf(t,n),r>=0?t.splice(r,1):void 0},fold:function(n,t,i){for(var f,r=0,u=n.length;r<u;r++)f=n[r],t=i(t,f);return t},flatMap:function(n,t){return i.fold(t,[],function(t,i){return t.concat(n(i))})},cached:function(n){var t;return t=l,function(){return t===l&&(t=n(),n=void 0),t}},isFunction:function(n){return typeof n=="function"},toString:function(n){var r,u,t,f;try{return ht++,n==null?"undefined":i.isFunction(n)?"function":a(n)?ht>5?"[..]":"["+i.map(i.toString,n).toString()+"]":(n!=null?n.toString:void 0)!=null&&n.toString!==Object.prototype.toString?n.toString():typeof n=="object"?ht>5?"{..}":(u=function(){var u=[];for(t in n)sr.call(n,t)&&(f=function(){try{return n[t]}catch(i){return r=i}}(),u.push(i.toString(t)+":"+i.toString(f)));return u}(),"{"+u+"}"):n}finally{ht--}}};ht=0;n._=i;c=n.UpdateBarrier=function(){var o,f,e,c,l,s,h,a,v,t,r,u,y,p;return t=void 0,r=[],u={},f=[],e=0,o=function(n){return t?f.push(n):n()},y=function(n,i){var f;return t?(f=u[n.id],f==null?(f=u[n.id]=[i],r.push(n)):f.push(i)):i()},l=function(){while(r.length>0)h(0);return void 0},h=function(n){var o,t,h,i,f,e;for(i=r[n],f=i.id,e=u[f],r.splice(n,1),delete u[f],s(i),t=0,h=e.length;t<h;t++)o=e[t],o();return void 0},s=function(n){var t,e,o,f,c;for(e=n.internalDeps(),f=0,c=e.length;f<c;f++)t=e[f],s(t),u[t.id]&&(o=i.indexOf(r,t),h(o));return void 0},v=function(n,i,r,u){var o,s;if(t)return r.apply(i,u);t=n;try{s=r.apply(i,u);l()}finally{for(t=void 0;e<f.length;)o=f[e],e++,o();e=0;f=[]}return s},c=function(){if(t)return t.id},p=function(t,i){var r,u,f,e;return e=!1,u=!1,r=function(){return u=!0},f=function(){return e=!0,r()},r=t.dispatcher.subscribe(function(t){return o(function(){var r;if(!e&&(r=i(t),r===n.noMore))return f()})}),u&&r(),f},a=function(){return r.length>0},{whenDoneWith:y,hasWaiters:a,inTransaction:v,currentEventId:c,wrappedSubscribe:p,afterTransaction:o}}();h=function(){function n(n,t,i){this.obs=n;this.sync=t;this.lazy=i!=null?i:!1;this.queue=[]}return n.prototype.subscribe=function(n){return this.obs.dispatcher.subscribe(n)},n.prototype.toString=function(){return this.obs.toString()},n.prototype.markEnded=function(){return this.ended=!0},n.prototype.consume=function(){return this.lazy?{value:i.always(this.queue[0])}:this.queue[0]},n.prototype.push=function(n){return this.queue=[n]},n.prototype.mayHave=function(){return!0},n.prototype.hasAtLeast=function(){return this.queue.length},n.prototype.flatten=!0,n}();li=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return v(t,n),t.prototype.consume=function(){return this.queue.shift()},t.prototype.push=function(n){return this.queue.push(n)},t.prototype.mayHave=function(n){return!this.ended||this.queue.length>=n},t.prototype.hasAtLeast=function(n){return this.queue.length>=n},t.prototype.flatten=!1,t}(h);hi=function(n){function t(n){t.__super__.constructor.call(this,n,!0)}return v(t,n),t.prototype.consume=function(){var n;return n=this.queue,this.queue=[],{value:function(){return n}}},t.prototype.push=function(n){return this.queue.push(n.value())},t.prototype.hasAtLeast=function(){return!0},t}(h);h.isTrigger=function(n){return n instanceof h?n.sync:n instanceof s};h.fromObservable=function(n){return n instanceof h?n:n instanceof p?new h(n,!1):new li(n,!0)};kt=function(){function n(n,t,i){this.context=n;this.method=t;this.args=i;this.cached=void 0}return n.prototype.deps=function(){return this.cached||(this.cached=ti([this.context].concat(this.args)))},n.prototype.apply=function(n){return n.desc=this,n},n.prototype.toString=function(){return i.toString(this.context)+"."+i.toString(this.method)+"("+i.map(i.toString,this.args)+")"},n}();f=function(){var i,n,t;return n=arguments[0],t=arguments[1],i=3<=arguments.length?r.call(arguments,2):[],(n||t)instanceof kt?n||t:new kt(n,t,i)};t=function(){var t,n,i;return t=2<=arguments.length?r.call(arguments,0,n=arguments.length-1):(n=0,[]),i=arguments[n++],f.apply(null,t).apply(i)};ti=function(n){return a(n)?i.flatMap(ti,n):ut(n)?[n]:n instanceof h?[n.obs]:[]};si=function(n){return function(){var t,u,i,f;return i=arguments[0],t=2<=arguments.length?r.call(arguments,1):[],typeof i=="object"&&t.length&&(u=i,f=t[0],i=function(){return u[f].apply(u,arguments)},t=t.slice(1)),n.apply(null,[i].concat(r.call(t)))}};b=function(n){return n=Array.prototype.slice.call(n),ui.apply(null,n)};ei=function(n,t){return function(){var i;return i=1<=arguments.length?r.call(arguments,0):[],n.apply(null,t.concat(i))}};er=function(n){return function(t){return function(r){var u;if(r!=null)return u=r[t],i.isFunction(u)?u.apply(r,n):u}}};ur=function(n,t){var r,u;return u=n.slice(1).split("."),r=i.map(er(t),u),function(t){for(var i=0,u=r.length;i<u;i++)n=r[i],t=n(t);return t}};ii=function(n){return typeof n=="string"&&n.length>1&&n.charAt(0)==="."};ui=si(function(){var t,n;return n=arguments[0],t=2<=arguments.length?r.call(arguments,1):[],i.isFunction(n)?t.length?ei(n,t):n:ii(n)?ur(n,t):i.always(n)});pt=function(n,t){return ui.apply(null,[n].concat(r.call(t)))};nt=function(n,t,i,r){var u;return t instanceof p?(u=t.sampledBy(n,function(n,t){return[n,t]}),r.call(u,function(n){var t,i;return t=n[0],i=n[1],t}).map(function(n){var i,t;return i=n[0],t=n[1],t})):(t=pt(t,i),r.call(n,t))};lt=function(n){var t;if(i.isFunction(n))return n;if(ii(n))return t=fr(n),function(n,i){return n[t](i)};throw new y("not a function or a field key: "+n);};fr=function(n){return n.slice(1)};g=function(){function n(n){this.value=n}return n.prototype.getOrElse=function(){return this.value},n.prototype.get=function(){return this.value},n.prototype.filter=function(t){return t(this.value)?new n(this.value):l},n.prototype.map=function(t){return new n(t(this.value))},n.prototype.forEach=function(n){return n(this.value)},n.prototype.isDefined=!0,n.prototype.toArray=function(){return[this.value]},n.prototype.inspect=function(){return"Some("+this.value+")"},n.prototype.toString=function(){return this.inspect()},n}();l={getOrElse:function(n){return n},filter:function(){return l},map:function(){return l},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}};oi=function(n){return n instanceof g||n===l?n:new g(n)};n.noMore=["<no-more>"];n.more=["<more>"];gi=0;d=function(){function n(){this.id=++gi}return n.prototype.isEvent=function(){return!0},n.prototype.isEnd=function(){return!1},n.prototype.isInitial=function(){return!1},n.prototype.isNext=function(){return!1},n.prototype.isError=function(){return!1},n.prototype.hasValue=function(){return!1},n.prototype.filter=function(){return!0},n.prototype.inspect=function(){return this.toString()},n.prototype.log=function(){return this.toString()},n}();ft=function(n){function t(n,r){t.__super__.constructor.call(this);!r&&i.isFunction(n)||n instanceof t?(this.valueF=n,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=n)}return v(t,n),t.prototype.isNext=function(){return!0},t.prototype.hasValue=function(){return!0},t.prototype.value=function(){return this.valueF instanceof t?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},t.prototype.fmap=function(n){var t,i;return this.valueInternal?(i=this.valueInternal,this.apply(function(){return n(i)})):(t=this,this.apply(function(){return n(t.value())}))},t.prototype.apply=function(n){return new t(n)},t.prototype.filter=function(n){return n(this.value())},t.prototype.toString=function(){return i.toString(this.value())},t.prototype.log=function(){return this.value()},t}(d);rt=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return v(t,n),t.prototype.isInitial=function(){return!0},t.prototype.isNext=function(){return!1},t.prototype.apply=function(n){return new t(n)},t.prototype.toNext=function(){return new ft(this)},t}(ft);dt=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return v(t,n),t.prototype.isEnd=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.toString=function(){return"<end>"},t}(d);w=function(n){function t(n){this.error=n}return v(t,n),t.prototype.isError=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.toString=function(){return"<error> "+i.toString(this.error)},t}(d);n.Event=d;n.Initial=rt;n.Next=ft;n.End=dt;n.Error=w;yt=function(n){return new rt(n,!0)};k=function(n){return new ft(n,!0)};u=function(){return new dt};wt=function(n){return n instanceof d?n:k(n)};ir=0;tt=function(){};e=function(){function n(n){this.id=++ir;t(n,this);this.initialDesc=this.desc}return n.prototype.subscribe=function(n){return c.wrappedSubscribe(this,n)},n.prototype.subscribeInternal=function(n){return this.dispatcher.subscribe(n)},n.prototype.onValue=function(){var n;return n=b(arguments),this.subscribe(function(t){if(t.hasValue())return n(t.value())})},n.prototype.onValues=function(n){return this.onValue(function(t){return n.apply(null,t)})},n.prototype.onError=function(){var n;return n=b(arguments),this.subscribe(function(t){if(t.isError())return n(t.error)})},n.prototype.onEnd=function(){var n;return n=b(arguments),this.subscribe(function(t){if(t.isEnd())return n()})},n.prototype.name=function(n){return this._name=n,this},n.prototype.withDescription=function(){return f.apply(null,arguments).apply(this)},n.prototype.toString=function(){return this._name?this._name:this.desc.toString()},n.prototype.internalDeps=function(){return this.initialDesc.deps()},n}();e.prototype.assign=e.prototype.onValue;e.prototype.forEach=e.prototype.onValue;e.prototype.inspect=e.prototype.toString;n.Observable=e;bt=function(){function n(n){var t,i,r;for(n==null&&(n=[]),this.unsubscribe=it(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[],t=0,i=n.length;t<i;t++)r=n[t],this.add(r)}return n.prototype.add=function(n){var r,t,u;if(!this.unsubscribed)return r=!1,t=o,this.starting.push(n),u=function(u){return function(){if(!u.unsubscribed)return r=!0,u.remove(t),i.remove(n,u.starting)}}(this),t=n(this.unsubscribe,u),this.unsubscribed||r?t():this.subscriptions.push(t),i.remove(n,this.starting),t},n.prototype.remove=function(n){if(!this.unsubscribed)return i.remove(n,this.subscriptions)!==void 0?n():void 0},n.prototype.unsubscribe=function(){var n,i,t,r;if(!this.unsubscribed){for(this.unsubscribed=!0,t=this.subscriptions,n=0,i=t.length;n<i;n++)r=t[n],r();return this.subscriptions=[],this.starting=[]}},n.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},n.prototype.empty=function(){return this.count()===0},n}();n.CompositeUnsubscribe=bt;at=function(){function t(n,t){this._subscribe=n;this._handleEvent=t;this.subscribe=it(this.subscribe,this);this.handleEvent=it(this.handleEvent,this);this.subscriptions=[];this.queue=[];this.pushing=!1;this.ended=!1;this.prevError=void 0;this.unsubSrc=void 0}return t.prototype.hasSubscribers=function(){return this.subscriptions.length>0},t.prototype.removeSub=function(n){return this.subscriptions=i.without(n,this.subscriptions)},t.prototype.push=function(n){return n.isEnd()&&(this.ended=!0),c.inTransaction(n,this,this.pushIt,[n])},t.prototype.pushToSubscriptions=function(t){var f,i,e,o,r,u;try{for(u=this.subscriptions,i=0,e=u.length;i<e;i++)r=u[i],o=r.sink(t),(o===n.noMore||t.isEnd())&&this.removeSub(r);return!0}catch(s){f=s;this.pushing=!1;this.queue=[];throw f;}},t.prototype.pushIt=function(t){if(this.pushing)return this.queue.push(t),n.more;if(t!==this.prevError){for(t.isError()&&(this.prevError=t),this.pushing=!0,this.pushToSubscriptions(t),this.pushing=!1;this.queue.length;)t=this.queue.shift(),this.push(t);return this.hasSubscribers()?n.more:(this.unsubscribeFromSource(),n.noMore)}},t.prototype.handleEvent=function(n){return this._handleEvent?this._handleEvent(n):this.push(n)},t.prototype.unsubscribeFromSource=function(){return this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},t.prototype.subscribe=function(n){var t;return this.ended?(n(u()),o):(ot(n),t={sink:n},this.subscriptions.push(t),this.subscriptions.length===1&&(this.unsubSrc=this._subscribe(this.handleEvent),ot(this.unsubSrc)),function(n){return function(){return n.removeSub(t),n.hasSubscribers()?void 0:n.unsubscribeFromSource()}}(this))},t}();s=function(t){function r(n,t,u){i.isFunction(n)&&(u=t,t=n,n=[]);r.__super__.constructor.call(this,n);ot(t);this.dispatcher=new at(t,u);tt(this)}return v(r,t),r.prototype.toProperty=function(t){var r,i;return i=arguments.length===0?l:oi(function(){return t}),r=this.dispatcher,new p(f(this,"toProperty",t),function(t){var u,f,s,e;return u=!1,e=o,f=n.more,s=function(){if(!u)return i.forEach(function(i){return u=!0,f=t(new rt(i)),f===n.noMore?(e(),e=o):void 0})},e=r.subscribe(function(r){return r.hasValue()?u&&r.isInitial()?n.more:(r.isInitial()||s(),u=!0,i=new g(r),t(r)):(r.isEnd()&&(f=s()),f!==n.noMore)?t(r):void 0}),s(),e})},r.prototype.toEventStream=function(){return this},r.prototype.withHandler=function(n){return new r(f(this,"withHandler",n),this.dispatcher.subscribe,n)},r}(e);n.EventStream=s;n.never=function(){return new s(f(n,"never"),function(n){return n(u()),o})};n.when=function(){var tt,t,l,d,y,p,g,it,rt,ut,w,a,v,b,nt,ft,o,e,k,ot;if(arguments.length===0)return n.never();for(g=arguments.length,ot="when: expecting arguments in the form (Observable+,function)+",et(ot,g%2==0),e=[],v=[],t=0,b=[];t<g;){for(b[t]=arguments[t],b[t+1]=arguments[t+1],a=i.toArray(arguments[t]),tt=ki(arguments[t+1]),w={f:tt,ixs:[]},k=!1,y=0,it=a.length;y<it;y++){for(o=a[y],l=i.indexOf(e,o),k||(k=h.isTrigger(o)),l<0&&(e.push(o),l=e.length-1),nt=w.ixs,p=0,rt=nt.length;p<rt;p++)d=nt[p],d.index===l&&d.count++;w.ixs.push({index:l,count:1})}et("At least one EventStream required",k||!a.length);a.length>0&&v.push(w);t=t+2}return e.length?(e=i.map(h.fromObservable,e),ut=i.any(e,function(n){return n.flatten})&&di(i.map(function(n){return n.obs},e)),ft=new s(f.apply(null,[n,"when"].concat(r.call(b))),function(r){var h,l,s,a,y,p,f;return f=[],s=!1,a=function(n){var i,u,r;for(r=n.ixs,i=0,u=r.length;i<u;i++)if(t=r[i],!e[t.index].hasAtLeast(t.count))return!1;return!0},l=function(n){return!n.sync||n.ended},h=function(n){var i,u,r;for(r=n.ixs,i=0,u=r.length;i<u;i++)if(t=r[i],!e[t.index].mayHave(t.count))return!0},y=function(n){return!n.source.flatten},p=function(o){return function(p){var w,b,k;return b=function(){return c.whenDoneWith(ft,w)},k=function(){var h,o,c,u,s,l;if(f.length>0){for(s=n.more,l=f.pop(),o=0,c=v.length;o<c;o++)if(u=v[o],a(u))return h=function(){var f,n,i,r;for(i=u.ixs,r=[],n=0,f=i.length;n<f;n++)t=i[n],r.push(e[t.index].consume());return r}(),s=r(l.e.apply(function(){var n,t;return t=function(){var r,t,i;for(i=[],t=0,r=h.length;t<r;t++)n=h[t],i.push(n.value());return i}(),u.f.apply(u,t)})),f.length&&(f=i.filter(y,f)),s===n.noMore?s:k()}else return n.more},w=function(){var t;return t=k(),s&&(s=!1,(i.all(e,l)||i.all(v,h))&&(t=n.noMore,r(u()))),t===n.noMore&&p(),t},o.subscribe(function(t){var i;return t.isEnd()?(s=!0,o.markEnded(),b()):t.isError()?i=r(t):(o.push(t),o.sync&&(f.push({source:o,e:t}),ut||c.hasWaiters()?b():w())),i===n.noMore&&p(),i||n.more})}},new n.CompositeUnsubscribe(function(){var n,i,t;for(t=[],n=0,i=e.length;n<i;n++)o=e[n],t.push(p(o));return t}()).unsubscribe})):n.never()};di=function(n,t){var r;return t==null&&(t=[]),r=function(n){var u;return i.contains(t,n)?!0:(u=n.internalDeps(),u.length?(t.push(n),i.any(u,r)):(t.push(n),!1))},i.any(n,r)};ki=function(n){return i.isFunction(n)?n:i.always(n)};n.groupSimultaneous=function(){var u,f,i;return i=1<=arguments.length?r.call(arguments,0):[],i.length===1&&a(i[0])&&(i=i[0]),f=function(){var n,r,t;for(t=[],n=0,r=i.length;n<r;n++)u=i[n],t.push(new hi(u));return t}(),t.apply(null,[n,"groupSimultaneous"].concat(r.call(i),[n.when(f,function(){return 1<=arguments.length?r.call(arguments,0):[]})]))};ai=function(t){function i(n,t,r){this.property=n;this.subscribe=it(this.subscribe,this);i.__super__.constructor.call(this,t,r);this.current=l;this.currentValueRootId=void 0;this.propertyEnded=!1}return v(i,t),i.prototype.push=function(n){return n.isEnd()&&(this.propertyEnded=!0),n.hasValue()&&(this.current=new g(n),this.currentValueRootId=c.currentEventId()),i.__super__.push.call(this,n)},i.prototype.maybeSubSource=function(t,i){return i===n.noMore?o:this.propertyEnded?(t(u()),o):at.prototype.subscribe.call(this,t)},i.prototype.subscribe=function(t){var u,f,i,r;return f=!1,i=n.more,this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)?(u=c.currentEventId(),r=this.currentValueRootId,!this.propertyEnded&&r&&u&&u!==r?(c.whenDoneWith(this.property,function(n){return function(){if(n.currentValueRootId===r)return t(yt(n.current.get().value()))}}(this)),this.maybeSubSource(t,i)):(c.inTransaction(void 0,this,function(){return i=t(yt(this.current.get().value()))},[]),this.maybeSubSource(t,i))):this.maybeSubSource(t,i)},i}(at);p=function(n){function t(n,r,u){i.isFunction(n)&&(u=r,r=n,n=[]);t.__super__.constructor.call(this,n);ot(r);this.dispatcher=new ai(this,r,u);tt(this)}return v(t,n),t.prototype.changes=function(){return new s(f(this,"changes"),function(n){return function(t){return n.dispatcher.subscribe(function(n){if(!n.isInitial())return t(n)})}}(this))},t.prototype.withHandler=function(n){return new t(f(this,"withHandler",n),this.dispatcher.subscribe,n)},t.prototype.toProperty=function(){return pi(arguments),this},t.prototype.toEventStream=function(){return new s(f(this,"toEventStream"),function(n){return function(t){return n.dispatcher.subscribe(function(n){return n.isInitial()&&(n=n.toNext()),t(n)})}}(this))},t}(e);n.Property=p;n.constant=function(t){return new p(f(n,"constant",t),function(n){return n(yt(t)),n(u()),o})};n.fromBinder=function(t,u){return u==null&&(u=i.id),new s(f(n,"fromBinder",t,u),function(f){var s,e,o,h;return h=!1,s=!1,e=function(){if(!h)return typeof o!="undefined"&&o!==null?(o(),h=!0):s=!0},o=t(function(){var c,s,h,l,o,t;for(c=1<=arguments.length?r.call(arguments,0):[],t=u.apply(this,c),a(t)&&i.last(t)instanceof d||(t=[t]),o=n.more,h=0,l=t.length;h<l;h++)if(s=t[h],o=f(s=wt(s)),o===n.noMore||s.isEnd())return e(),o;return o}),s&&e(),e})};ni=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]];nr=function(n){for(var i,r,t=0,u=ni.length;t<u;t++)if(r=ni[t],i=[n[r[0]],n[r[1]]],i[0]&&i[1])return i;throw new w("No suitable event methods in "+n);};n.fromEventTarget=function(i,r,u){var f,e,o;return f=nr(i),e=f[0],o=f[1],t(n,"fromEvent",i,r,n.fromBinder(function(n){return e.call(i,r,n),function(){return o.call(i,r,n)}},u))};n.fromEvent=n.fromEventTarget;n.Observable.prototype.map=function(){var n,i;return i=arguments[0],n=2<=arguments.length?r.call(arguments,1):[],nt(this,i,n,function(n){return t(this,"map",n,this.withHandler(function(t){return this.push(t.fmap(n))}))})};n.combineAsArray=function(){var u,f,o,s,c,e,i;for(i=1<=arguments.length?r.call(arguments,0):[],i.length===1&&a(i[0])&&(i=i[0]),u=f=0,o=i.length;f<o;u=++f)e=i[u],ut(e)||(i[u]=n.constant(e));return i.length?(c=function(){var n,r,t;for(t=[],n=0,r=i.length;n<r;n++)s=i[n],t.push(new h(s,!0));return t}(),t.apply(null,[n,"combineAsArray"].concat(r.call(i),[n.when(c,function(){return 1<=arguments.length?r.call(arguments,0):[]}).toProperty()]))):n.constant([])};n.onValues=function(){var i,t,u;u=2<=arguments.length?r.call(arguments,0,t=arguments.length-1):(t=0,[]);i=arguments[t++];return n.combineAsArray(u).onValues(i)};n.combineWith=function(){var i,u;return i=arguments[0],u=2<=arguments.length?r.call(arguments,1):[],t.apply(null,[n,"combineWith",i].concat(r.call(u),[n.combineAsArray(u).map(function(n){return i.apply(null,n)})]))};n.combineTemplate=function(r){var h,c,l,o,v,y,u,s,f,e;return u=[],e=[],y=function(n){return n[n.length-1]},f=function(n,t,i){return y(n)[t]=i},h=function(n,t){return function(i,r){return f(i,n,r[t])}},v=function(n,t){return function(i){return f(i,n,t)}},s=function(n){return a(n)?[]:{}},l=function(n,t){var i,r;return ut(t)?(e.push(t),u.push(h(n,e.length-1))):t!==Object(t)||typeof t=="function"||t instanceof RegExp||t instanceof Date?u.push(v(n,t)):(r=function(n){return function(i){var r;return r=s(t),f(i,n,r),i.push(r)}},i=function(n){return n.pop()},u.push(r(n)),o(t),u.push(i))},o=function(n){return i.each(n,l)},o(r),c=function(n){var f,e,t,o,i;for(i=s(r),f=[i],t=0,o=u.length;t<o;t++)e=u[t],e(f,n);return i},t(n,"combineTemplate",r,n.combineAsArray(e).map(c))};n.Observable.prototype.combine=function(i,r){var u;return u=lt(r),t(this,"combine",i,r,n.combineAsArray(this,i).map(function(n){return u(n[0],n[1])}))};n.Observable.prototype.decode=function(i){return t(this,"decode",i,this.combine(n.combineTemplate(i),function(n,t){return t[n]}))};n.Observable.prototype.withStateMachine=function(i,r){var u;return u=i,t(this,"withStateMachine",i,r,this.withHandler(function(t){var e,f,s,h,c,o,i;for(e=r(u,t),h=e[0],o=e[1],u=h,i=n.more,f=0,s=o.length;f<s;f++)if(c=o[f],i=this.push(c),i===n.noMore)return i;return i}))};n.Observable.prototype.skipDuplicates=function(n){return n==null&&(n=function(n,t){return n===t}),t(this,"skipDuplicates",this.withStateMachine(l,function(t,i){return i.hasValue()?i.isInitial()||t===l||!n(t.get(),i.value())?[new g(i.value()),[i]]:[t,[]]:[t,[i]]}))};n.Observable.prototype.awaiting=function(i){return t(this,"awaiting",i,n.groupSimultaneous(this,i).map(function(n){var i,t;return i=n[0],t=n[1],t.length===0}).toProperty(!1).skipDuplicates())};n.Observable.prototype.not=function(){return t(this,"not",this.map(function(n){return!n}))};n.Property.prototype.and=function(n){return t(this,"and",n,this.combine(n,function(n,t){return n&&t}))};n.Property.prototype.or=function(n){return t(this,"or",n,this.combine(n,function(n,t){return n||t}))};n.scheduler={setTimeout:function(n,t){return setTimeout(n,t)},setInterval:function(n,t){return setInterval(n,t)},clearInterval:function(n){return clearInterval(n)},clearTimeout:function(n){return clearTimeout(n)},now:function(){return(new Date).getTime()}};n.EventStream.prototype.bufferWithTime=function(n){return t(this,"bufferWithTime",n,this.bufferWithTimeOrCount(n,Number.MAX_VALUE))};n.EventStream.prototype.bufferWithCount=function(n){return t(this,"bufferWithCount",n,this.bufferWithTimeOrCount(void 0,n))};n.EventStream.prototype.bufferWithTimeOrCount=function(n,i){var r;return r=function(t){return t.values.length===i?t.flush():n!==void 0?t.schedule():void 0},t(this,"bufferWithTimeOrCount",n,i,this.buffer(n,r,r))};n.EventStream.prototype.buffer=function(r,u,f){var e,h,s;return u==null&&(u=o),f==null&&(f=o),e={scheduled:null,end:void 0,values:[],flush:function(){var t;if(this.scheduled&&(n.scheduler.clearTimeout(this.scheduled),this.scheduled=null),this.values.length>0){if(t=this.push(k(this.values)),this.values=[],this.end!=null)return this.push(this.end);if(t!==n.noMore)return f(this)}else if(this.end!=null)return this.push(this.end)},schedule:function(){if(!this.scheduled)return this.scheduled=r(function(n){return function(){return n.flush()}}(this))}},s=n.more,i.isFunction(r)||(h=r,r=function(t){return n.scheduler.setTimeout(t,h)}),t(this,"buffer",this.withHandler(function(n){return e.push=function(n){return function(t){return n.push(t)}}(this),n.isError()?s=this.push(n):n.isEnd()?(e.end=n,e.scheduled||e.flush()):(e.values.push(n.value()),u(e)),s}))};n.Observable.prototype.filter=function(){var i,u;return u=arguments[0],i=2<=arguments.length?r.call(arguments,1):[],nt(this,u,i,function(i){return t(this,"filter",i,this.withHandler(function(t){return t.filter(i)?this.push(t):n.more}))})};n.once=function(t){return new s(f(n,"once",t),function(n){return n(wt(t)),n(u()),o})};n.EventStream.prototype.concat=function(n){var t;return t=this,new s(f(t,"concat",n),function(i){var u,r;return r=o,u=t.dispatcher.subscribe(function(t){return t.isEnd()?r=n.dispatcher.subscribe(i):i(t)}),function(){return u(),r()}})};n.Observable.prototype.flatMap=function(){return vt(this,st(arguments))};n.Observable.prototype.flatMapFirst=function(){return vt(this,st(arguments),!0)};vt=function(t,r,e,o){var h,c,l;return l=[t],h=[],c=new s(f(t,"flatMap"+(e?"First":""),r),function(f){var c,v,s,l,a;return s=new bt,l=[],a=function(t){var u;return u=fi(r(t.value())),h.push(u),s.add(function(t,r){return u.dispatcher.subscribe(function(e){var o;return e.isEnd()?(i.remove(u,h),v(),c(r),n.noMore):(e instanceof rt&&(e=e.toNext()),o=f(e),o===n.noMore&&t(),o)})})},v=function(){var n;return n=l.shift(),n?a(n):void 0},c=function(n){return n(),s.empty()?f(u()):void 0},s.add(function(i,r){return t.dispatcher.subscribe(function(t){return t.isEnd()?c(r):t.isError()?f(t):e&&s.count()>1?n.more:s.unsubscribed?n.noMore:o&&s.count()>o?l.push(t):a(t)})}),s.unsubscribe}),c.internalDeps=function(){return h.length?l.concat(h):l},c};st=function(n){return n.length===1&&ut(n[0])?i.always(n[0]):b(n)};fi=function(t){return ut(t)?t:n.once(t)};n.Observable.prototype.flatMapWithConcurrencyLimit=function(){var n,i;return i=arguments[0],n=2<=arguments.length?r.call(arguments,1):[],t.apply(null,[this,"flatMapWithConcurrencyLimit",i].concat(r.call(n),[vt(this,st(n),!1,i)]))};n.Observable.prototype.flatMapConcat=function(){return t.apply(null,[this,"flatMapConcat"].concat(r.call(arguments),[this.flatMapWithConcurrencyLimit.apply(this,[1].concat(r.call(arguments)))]))};gt=function(t,i){var r;return r=new s(f(t,"justInitValue"),function(i){var e,f;return f=void 0,e=t.dispatcher.subscribe(function(t){return t.isEnd()||(f=t),n.noMore}),c.whenDoneWith(r,function(){return f!=null&&i(f),i(u())}),e}),r.concat(i).toProperty()};n.Observable.prototype.mapEnd=function(){var i;return i=b(arguments),t(this,"mapEnd",i,this.withHandler(function(t){return t.isEnd()?(this.push(k(i(t))),this.push(u()),n.noMore):this.push(t)}))};n.Observable.prototype.skipErrors=function(){return t(this,"skipErrors",this.withHandler(function(t){return t.isError()?n.more:this.push(t)}))};n.EventStream.prototype.takeUntil=function(i){var r;return r={},t(this,"takeUntil",i,n.groupSimultaneous(this.mapEnd(r),i.skipErrors()).withHandler(function(t){var e,f,c,o,s,h;if(t.hasValue()){if(o=t.value(),e=o[0],i=o[1],i.length)return this.push(u());for(s=n.more,f=0,c=e.length;f<c;f++)h=e[f],s=h===r?this.push(u()):this.push(k(h));return s}return this.push(t)}))};n.Property.prototype.takeUntil=function(n){var i;return i=this.changes().takeUntil(n),t(this,"takeUntil",n,gt(this,i))};n.Observable.prototype.flatMapLatest=function(){var n,i;return n=st(arguments),i=this.toEventStream(),t(this,"flatMapLatest",n,i.flatMap(function(t){return fi(n(t)).takeUntil(i)}))};n.fromPoll=function(i,r){return t(n,"fromPoll",i,r,n.fromBinder(function(t){var r;return r=n.scheduler.setInterval(t,i),function(){return n.scheduler.clearInterval(r)}},r))};n.later=function(i,r){return t(n,"later",i,r,n.fromBinder(function(t){var f,e;return e=function(){return t([r,u()])},f=n.scheduler.setTimeout(e,i),function(){return n.scheduler.clearTimeout(f)}}))};n.sequentially=function(i,r){var f;return f=0,t(n,"sequentially",i,r,n.fromPoll(i,function(){var n;return n=r[f++],f<r.length?n:f===r.length?[n,u()]:u()}))};n.repeatedly=function(i,r){var u;return u=0,t(n,"repeatedly",i,r,n.fromPoll(i,function(){return r[u++%r.length]}))};n.interval=function(i,r){return r==null&&(r={}),t(n,"interval",i,r,n.fromPoll(i,function(){return k(r)}))};n.EventStream.prototype.delay=function(i){return t(this,"delay",i,this.flatMap(function(t){return n.later(i,t)}))};n.Property.prototype.delay=function(n){return this.delayChanges("delay",n,function(t){return t.delay(n)})};n.Property.prototype.delayChanges=function(){var i,u,n;return i=2<=arguments.length?r.call(arguments,0,n=arguments.length-1):(n=0,[]),u=arguments[n++],t.apply(null,[this].concat(r.call(i),[gt(this,u(this.changes()))]))};n.Observable.prototype.bufferingThrottle=function(i){return t(this,"bufferingThrottle",i,this.flatMapConcat(function(t){return n.once(t).concat(n.later(i).filter(!1))}))};n.Property.prototype.bufferingThrottle=function(){return n.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()};ci=function(t){function i(){this.guardedSink=it(this.guardedSink,this);this.subscribeAll=it(this.subscribeAll,this);this.unsubAll=it(this.unsubAll,this);this.sink=void 0;this.subscriptions=[];this.ended=!1;i.__super__.constructor.call(this,f(n,"Bus"),this.subscribeAll)}return v(i,t),i.prototype.unsubAll=function(){var n,r,t,i;for(t=this.subscriptions,n=0,r=t.length;n<r;n++)i=t[n],typeof i.unsub=="function"&&i.unsub();return void 0},i.prototype.subscribeAll=function(n){var t,r,i,u;for(this.sink=n,i=bi(this.subscriptions),t=0,r=i.length;t<r;t++)u=i[t],this.subscribeInput(u);return this.unsubAll},i.prototype.guardedSink=function(t){return function(i){return function(r){return r.isEnd()?(i.unsubscribeInput(t),n.noMore):i.sink(r)}}(this)},i.prototype.subscribeInput=function(n){return n.unsub=n.input.dispatcher.subscribe(this.guardedSink(n.input))},i.prototype.unsubscribeInput=function(n){var t,r,f,u,i;for(u=this.subscriptions,t=r=0,f=u.length;r<f;t=++r)if(i=u[t],i.input===n){typeof i.unsub=="function"&&i.unsub();this.subscriptions.splice(t,1);return}},i.prototype.plug=function(n){var t;if(wi(n),!this.ended)return t={input:n},this.subscriptions.push(t),this.sink!=null&&this.subscribeInput(t),function(t){return function(){return t.unsubscribeInput(n)}}(this)},i.prototype.end=function(){return this.ended=!0,this.unsubAll(),typeof this.sink=="function"?this.sink(u()):void 0},i.prototype.push=function(n){if(typeof this.sink=="function")return this.sink(k(n))},i.prototype.error=function(n){if(typeof this.sink=="function")return this.sink(new w(n))},i}(s);n.Bus=ci;ri=function(i,u){return si(function(){var f,e,o;return e=arguments[0],f=2<=arguments.length?r.call(arguments,1):[],o=ei(u,[function(n,t){return e.apply(null,r.call(n).concat([t]))}]),t.apply(null,[n,i,e].concat(r.call(f),[n.combineAsArray(f).flatMap(o)]))})};n.fromCallback=ri("fromCallback",function(){var t,i;return i=arguments[0],t=2<=arguments.length?r.call(arguments,1):[],n.fromBinder(function(n){return pt(i,t)(n),o},function(n){return[n,u()]})});n.fromNodeCallback=ri("fromNodeCallback",function(){var t,i;return i=arguments[0],t=2<=arguments.length?r.call(arguments,1):[],n.fromBinder(function(n){return pt(i,t)(n),o},function(n,t){return n?[new w(n),u()]:[t,u()]})});n.EventStream.prototype.debounce=function(i){return t(this,"debounce",i,this.flatMapLatest(function(t){return n.later(i,t)}))};n.Property.prototype.debounce=function(n){return this.delayChanges("debounce",n,function(t){return t.debounce(n)})};n.EventStream.prototype.debounceImmediate=function(i){return t(this,"debounceImmediate",i,this.flatMapFirst(function(t){return n.once(t).concat(n.later(i).filter(!1))}))};n.Observable.prototype.scan=function(t,i){var r,u,e;return i=lt(i),r=oi(t),e=function(t){return function(f){var e,s,l,h;return e=!1,h=o,s=n.more,l=function(){if(!e)return r.forEach(function(t){return e=!0,s=f(new rt(function(){return t})),s===n.noMore?(h(),h=o):void 0})},h=t.dispatcher.subscribe(function(t){var u,o;return t.hasValue()?e&&t.isInitial()?n.more:(t.isInitial()||l(),e=!0,o=r.getOrElse(void 0),u=i(o,t.value()),r=new g(u),f(t.apply(function(){return u}))):(t.isEnd()&&(s=l()),s!==n.noMore)?f(t):void 0}),c.whenDoneWith(u,l),h}}(this),u=new p(f(this,"scan",t,i),e)};n.Observable.prototype.diff=function(n,i){return i=lt(i),t(this,"diff",n,i,this.scan([n],function(n,t){return[t,i(n[0],t)]}).filter(function(n){return n.length===2}).map(function(n){return n[1]}))};n.Observable.prototype.doAction=function(){var n;return n=b(arguments),t(this,"doAction",n,this.withHandler(function(t){return t.hasValue()&&n(t.value()),this.push(t)}))};n.Observable.prototype.endOnError=function(){var i,n;return n=arguments[0],i=2<=arguments.length?r.call(arguments,1):[],n==null&&(n=!0),nt(this,n,i,function(n){return t(this,"endOnError",this.withHandler(function(t){return t.isError()&&n(t.error)?(this.push(t),this.push(u())):this.push(t)}))})};e.prototype.errors=function(){return t(this,"errors",this.filter(function(){return!1}))};or=function(n){return[n,u()]};n.fromPromise=function(i,r){return t(n,"fromPromise",i,n.fromBinder(function(n){var t;return(t=i.then(n,function(t){return n(new w(t))}))!=null&&typeof t.done=="function"&&t.done(),function(){if(r)return typeof i.abort=="function"?i.abort():void 0}},or))};n.Observable.prototype.mapError=function(){var n;return n=b(arguments),t(this,"mapError",n,this.withHandler(function(t){return t.isError()?this.push(k(n(t.error))):this.push(t)}))};n.Observable.prototype.flatMapError=function(i){return t(this,"flatMapError",i,this.mapError(function(n){return new w(n)}).flatMap(function(t){return t instanceof w?i(t.error):n.once(t)}))};n.EventStream.prototype.sampledBy=function(n,i){return t(this,"sampledBy",n,i,this.toProperty().sampledBy(n,i))};n.Property.prototype.sampledBy=function(i,r){var u,e,o,f,s;return r!=null?r=lt(r):(u=!0,r=function(n){return n.value()}),s=new h(this,!1,u),o=new h(i,!0,u),f=n.when([s,o],r),e=i instanceof p?f.toProperty():f,t(this,"sampledBy",i,r,e)};n.Property.prototype.sample=function(i){return t(this,"sample",i,this.sampledBy(n.interval(i,{})))};n.Observable.prototype.map=function(){var i,n;return n=arguments[0],i=2<=arguments.length?r.call(arguments,1):[],n instanceof p?n.sampledBy(this,tr):nt(this,n,i,function(n){return t(this,"map",n,this.withHandler(function(t){return this.push(t.fmap(n))}))})};n.Observable.prototype.fold=function(n,i){return t(this,"fold",n,i,this.scan(n,i).sampledBy(this.filter(!1).mapEnd().toProperty()))};e.prototype.reduce=e.prototype.fold;n.EventStream.prototype.merge=function(i){var r;return yi(i),r=this,t(r,"merge",i,n.mergeAll(this,i))};n.mergeAll=function(){var t;return t=1<=arguments.length?r.call(arguments,0):[],a(t[0])&&(t=t[0]),t.length?new s(f.apply(null,[n,"mergeAll"].concat(r.call(t))),function(r){var f,e,o;return f=0,o=function(i){return function(e){return i.dispatcher.subscribe(function(i){var o;return i.isEnd()?(f++,f===t.length?r(u()):n.more):(o=r(i),o===n.noMore&&e(),o)})}},e=i.map(o,t),new n.CompositeUnsubscribe(e).unsubscribe}):n.never()};n.Observable.prototype.take=function(i){return i<=0?n.never():t(this,"take",i,this.withHandler(function(t){return t.hasValue()?(i--,i>0?this.push(t):(i===0&&this.push(t),this.push(u()),n.noMore)):this.push(t)}))};n.fromArray=function(i){var r;return vi(i),i.length?(r=0,new s(f(n,"fromArray",i),function(t){var e,f,o;return o=!1,f=n.more,e=function(){var s;if(f!==n.noMore&&!o&&(s=i[r++],f=t(wt(s)),f!==n.noMore))return r===i.length?t(u()):c.afterTransaction(e)},e(),function(){return o=!0}})):t(n,"fromArray",i,n.never())};n.EventStream.prototype.holdWhen=function(r){var f,e,u;return u=r.startWith(!1),e=u.filter(function(n){return!n}),f=u.filter(i.id),t(this,"holdWhen",r,this.filter(!1).merge(u.flatMapConcat(function(t){return function(i){return i?t.scan([],function(n,t){return n.concat([t])}).sampledBy(e).take(1).flatMap(n.fromArray):t.takeUntil(f)}}(this))))};n.$={};n.$.asEventStream=function(r,u,f){var e;return i.isFunction(u)&&(e=[u,void 0],f=e[0],u=e[1]),t(this.selector||this,"asEventStream",r,n.fromBinder(function(n){return function(t){n.on(r,u,t);return function(){return n.off(r,u,t)}}}(this),f))};(rr=typeof jQuery!="undefined"&&jQuery!==null?jQuery:typeof Zepto!="undefined"&&Zepto!==null?Zepto:void 0)!=null&&(rr.fn.asEventStream=n.$.asEventStream);n.Observable.prototype.log=function(){var n;return n=1<=arguments.length?r.call(arguments,0):[],this.subscribe(function(t){if(typeof console!="undefined"&&console!==null)return typeof console.log=="function"?console.log.apply(console,r.call(n).concat([t.log()])):void 0}),this};n.repeat=function(t){var i;return i=0,n.fromBinder(function(r){var f,h,e,o,s;return f=!1,e=n.more,s=function(){},h=function(n){return n.isEnd()?f?o():f=!0:e=r(n)},o=function(){var o;for(f=!0;f&&e!==n.noMore;)o=t(i++),f=!1,o?s=o.subscribeInternal(h):r(u());return f=!0},o(),function(){return s()}})};n.retry=function(r){var o,u,e,s,h,f,c;if(!i.isFunction(r.source))throw new y("'source' option has to be a function");return c=r.source,f=r.retries||0,h=r.maxRetries||f,o=r.delay||function(){return 0},s=r.isRetryable||function(){return!0},e=!1,u=null,t(n,"retry",r,n.repeat(function(){var i,r,t;return e?null:(t=function(){return c().endOnError().withHandler(function(n){if(n.isError()){if(u=n,!s(u.error)||!(f>0))return e=!0,this.push(n)}else return n.hasValue()&&(u=null,e=!0),this.push(n)})},u?(i={error:u.error,retriesDone:h-f},r=n.later(o(i)).filter(!1),f=f-1,r.concat(n.once().flatMap(t))):t())}))};n.Observable.prototype.skip=function(i){return t(this,"skip",i,this.withHandler(function(t){return t.hasValue()?i>0?(i--,n.more):this.push(t):this.push(t)}))};n.EventStream.prototype.skipUntil=function(n){var i;return i=n.take(1).map(!0).toProperty(!1),t(this,"skipUntil",n,this.filter(i))};n.EventStream.prototype.skipWhile=function(){var u,f,i;return f=arguments[0],u=2<=arguments.length?r.call(arguments,1):[],i=!1,nt(this,f,u,function(r){return t(this,"skipWhile",r,this.withHandler(function(t){return!i&&t.hasValue()&&r(t.value())?n.more:(t.hasValue()&&(i=!0),this.push(t))}))})};n.Observable.prototype.slidingWindow=function(n,i){return i==null&&(i=0),t(this,"slidingWindow",n,i,this.scan([],function(t,i){return t.concat([i]).slice(-n)}).filter(function(n){return n.length>=i}))};n.spy=function(n){return ct.push(n)};ct=[];tt=function(n){var t,i,r;if(ct.length&&!tt.running)try{for(tt.running=!0,t=0,i=ct.length;t<i;t++)r=ct[t],r(n)}finally{delete tt.running}return void 0};n.Property.prototype.startWith=function(n){return t(this,"startWith",n,this.scan(n,function(n,t){return t}))};n.EventStream.prototype.startWith=function(i){return t(this,"startWith",i,n.once(i).concat(this))};n.Observable.prototype.takeWhile=function(){var i,f;return f=arguments[0],i=2<=arguments.length?r.call(arguments,1):[],nt(this,f,i,function(i){return t(this,"takeWhile",i,this.withHandler(function(t){return t.filter(i)?this.push(t):(this.push(u()),n.noMore)}))})};n.update=function(){var i,f,e,u;for(f=arguments[0],u=2<=arguments.length?r.call(arguments,1):[],e=function(n){return function(){var t;return t=1<=arguments.length?r.call(arguments,0):[],function(i){return n.apply(null,[i].concat(t))}}},i=u.length-1;i>0;)u[i]instanceof Function||(u[i]=function(n){return function(){return n}}(u[i])),u[i]=e(u[i]),i=i-2;return t.apply(null,[n,"update",f].concat(r.call(u),[n.when.apply(n,u).scan(f,function(n,t){return t(n)})]))};n.zipAsArray=function(){var i;return i=1<=arguments.length?r.call(arguments,0):[],a(i[0])&&(i=i[0]),t.apply(null,[n,"zipAsArray"].concat(r.call(i),[n.zipWith(i,function(){return 1<=arguments.length?r.call(arguments,0):[]})]))};n.zipWith=function(){var f,e,u;return f=arguments[0],u=2<=arguments.length?r.call(arguments,1):[],i.isFunction(f)||(e=[f,u[0]],u=e[0],f=e[1]),u=i.map(function(n){return n.toEventStream()},u),t.apply(null,[n,"zipWith",f].concat(r.call(u),[n.when(u,f)]))};n.Observable.prototype.zip=function(i,r){return r==null&&(r=Array),t(this,"zip",i,n.zipWith([this,i],r))};n.Observable.prototype.first=function(){return t(this,"first",this.take(1))};n.Observable.prototype.last=function(){var i;return t(this,"last",this.withHandler(function(t){if(t.isEnd())return i&&this.push(i),this.push(u()),n.noMore;i=t}))};n.EventStream.prototype.throttle=function(n){return t(this,"throttle",n,this.bufferWithTime(n).map(function(n){return n[n.length-1]}))};n.Property.prototype.throttle=function(n){return this.delayChanges("throttle",n,function(t){return t.throttle(n)})};e.prototype.firstToPromise=function(t){var i=this;if(typeof t!="function")if(typeof Promise=="function")t=Promise;else throw new y("There isn't default Promise, use shim or parameter");return new t(function(t,r){return i.subscribe(function(i){return i.hasValue()&&t(i.value()),i.isError()&&r(i.error),n.noMore})})};e.prototype.toPromise=function(n){return this.last().firstToPromise(n)};typeof define!="undefined"&&define!==null&&define.amd!=null?(define([],function(){return n}),this.Bacon=n):typeof module!="undefined"&&module!==null&&module.exports!=null?(module.exports=n,n.Bacon=n):this.Bacon=n}).call(this);
//# sourceMappingURL=Bacon.min.js.map
